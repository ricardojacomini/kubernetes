# roles/kubernetes/handlers/main.yml

- name: "ğŸ“¡ Gather service facts before restarting kubelet"
  ansible.builtin.service_facts:
  listen: "ğŸ”„ Restart Kubelet"
  become: true

- name: "ğŸ” Restart kubelet only if service exists"
  ansible.builtin.systemd:
    name: kubelet
    state: restarted
    enabled: yes
  when: "'kubelet.service' in ansible_facts.services"
  listen: "ğŸ”„ Restart Kubelet"
  become: true

- name: "ğŸ”„ Restart containerd"
  ansible.builtin.service:
    name: containerd
    state: restarted
  become: true

- name: "ğŸ”„ Restart network"
  ansible.builtin.systemd:
    name: network
    state: restarted
  become: true
