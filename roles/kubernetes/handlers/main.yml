# roles/kubernetes/handlers/main.yml

- name: "ğŸ”„ Restart Kubelet"
  block:
    - name: "ğŸ“¡ Gather service facts before restarting kubelet"
      ansible.builtin.service_facts:

    - name: "ğŸ” Restart kubelet only if service exists"
      ansible.builtin.systemd:
        name: kubelet
        state: restarted
        enabled: yes
      when: "'kubelet.service' in ansible_facts.services"
  become: true  # ğŸ” Added here to cover both tasks

- name: "ğŸ”„ Restart containerd"
  ansible.builtin.service:
    name: containerd
    state: restarted
  become: true

- name: "ğŸ”„ Restart network"
  ansible.builtin.systemd:
    name: network
    state: restarted
  become: true
